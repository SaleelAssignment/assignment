DBT Assignment 

--
-- Assignment
--

1. Write a query to display the names (first_name, last_name) using alias name â€œFirst Name", "Last Name".
2. Write a query to get unique department ID from employee table..
3. Write a query to get all employee details from the employee table order by first name, descending.
4. Write a query to get the names (first_name, last_name), salary, PF of all the employees (PF is calculated as 15% of salary).
5. Write a query to get the employee ID, names (first_name, last_name), salary in ascending order of salary.
6. Write a query to get the total salaries payable to employees.
7. Write a query to get the maximum and minimum salary from employees table.
8. Write a query to get the average salary and number of employees in the employees table.
9. Write a query to get the number of employees working with the company.
10. Write a query to get the number of jobs available in the employees table.
11. Write a query get all first name from employees table in upper case.
12. Write a query to get the first 3 characters of first name from employees table.
13. Write a query to calculate 171*214+625. 
14. Write a query to get the names (for example Ellen Abel, Sundar Ande etc.) of all the employees from employees table.
15. Write a query to get first name from employees table after removing white spaces from both side. 
16. Write a query to get the length of the employee names (first_name, last_name) from employees table. 
17. Write a query to check if the first_name fields of the employees table contains numbers.
18. Write a query to select first 10 records from a table. 
19. Write a query to get monthly salary (round 2 decimal places) of each and every employee
20. Write a query to display the name (first_name, last_name) and salary for all employees whose salary is not in the range $10,000 through $15,000.
21. Write a query to display the name (first_name, last_name) and department ID of all employees in departments 30 or 100 in ascending order.
22. Write a query to display the name (first_name, last_name) and salary for all employees whose salary is not in the range $10,000 through $15,000 and are in department 30 or 100.
23. Write a query to display the name (first_name, last_name) and hire date for all employees who were hired in 1987.
24. Write a query to display the first_name of all employees who have both "b" and "c" in their first name.
25. Write a query to display the last name, job, and salary for all employees whose job is that of a Programmer or a Shipping Clerk, and whose salary is not equal to $4,500, $10,000, or $15,000.
26. Write a query to display the last name of employees whose names have exactly 6 characters.
27. Write a query to display the last name of employees having 'e' as the third character.
28. Write a query to display the jobs/designations available in the employees table.
29. Write a query to display the name (first_name, last_name), salary and PF (15% of salary) of all employees.
30. Write a query to select all record from employees where last name in 'BLAKE', 'SCOTT', 'KING' and 'FORD'.
31. Write a query to get the details of the employees where the length of the first name greater than or equal to 8.
32. Write a query to display leading zeros before maximum and minimum salary.
33. Write a query to get the employee id, email id (discard the last four characters from emailID).
34. Write a query to find all employees where first names are in upper case.
35. Write a query to extract the last 4 character of phone numbers.
36. Write a query to display the first word from those job titles which contains more than one words.
37. Write a query to display the length of first name for employees where last name contain character 'c' after 2nd position.
38. Write a query that displays the first name and the length of the first name for all employees whose name starts with the letters 'A', 'J' or 'M'. Give each column an appropriate label. Sort the results by the employees' first names.
39. Write a query to display the first name and salary for all employees. Format the salary to be 10 characters long, left-padded with the $ symbol. Label the column SALARY.
40. Write a query to list the number of jobs available in the employees table.
41. Write a query to get the total salaries payable to employees.
42. Write a query to get the minimum salary from employees table.
43. Write a query to get the maximum salary of an employee working as a Programmer.
44. Write a query to get the average salary and number of employees working the department 90.
45. Write a query to get the highest, lowest, sum, and average salary of all employees.
46. Write a query to get the number of employees with the same job.
47. Write a query to get the difference between the highest and lowest salaries.
48. Write a query to find the manager ID and the salary of the lowest-paid employee for that manager.
49. Write a query to get the department ID and the total salary payable in each department.
50. Write a query to get the average salary for each job ID excluding programmer.
51. Write a query to get the total salary, maximum, minimum, average salary of employees (job ID wise), for department ID 90 only.
52. Write a query to get the job ID and maximum salary of the employees where maximum salary is greater than or equal to $4000.
53. Write a query to get the average salary for all departments employing more than 10 employees.

************** Subquery **************

54. Write a query to display the name ( first name and last name ) for those employees who gets more salary than the employee whose id is 163.
55. Write a query to display the name ( first name and last name ), salary, department id, job id for those employees who works in the same designation as the employee works whose id is 169.
56. Write a query to display the name ( first name and last name ), salary, department id for those employees who earn such amount of salary which is the smallest salary of any of the departments.
57. Write a query to display the employee id, employee name (first name and last name ) for all employees who earn more than the average salary.
58. Write a query to display the employee name ( first name and last name ), employee id and salary of all employees who report to Payam.
59. Write a query to display the department number, name ( first name and last name ), job and department name for all employees in the Finance department.
60. Write a query to display all the information of an employee whose salary and reporting person id is 3000 and 121 respectively.
61. Write a statement to display all the information of an employee whose id is any of the number 134, 159 and 183.
62. Write a query to display all the information of the employees whose salary is within the range 1000 and 3000.
63. Write a query to display all the information of the employees whose salary if within the range of smallest salary and 2500.
64. Write a query to display all the information of the employees who does not work in those departments where some employees works whose manager id within the range 100 and 200.
65. Write a query to display all the information for those employees whose id is any id who earn the second highest salary.
66. Write a query to display the employee name( first name and last name ) and hiredate for all employees in the same department as Clara. Exclude Clara.
67. Write a query to display the employee ID and name ( first name and last name ) of all employees who works in such a department where the employees are working whose name containing a letter 'T'. 
68. Write a query to display the employee number, name( first name and last name ), and salary for all employees who earn more than the average salary and who work in a department with any employee with a 'J' in their name.
69. Display the employee name( first name and last name ), employee id, and job title for all employees whose department location is Toronto.
70. Write a query to display the employee number, name( first name and last name ) and job title for all employees whose salary is smaller than any salary of those employees whose job title is MK_MAN.
71. Write a query to display the employee number, name( first name and last name ) and job title for all employees whose salary is smaller than any salary of those employees whose job title is MK_MAN. Exclude Job title MK_MAN.
72. Write a query to display the employee number, name( first name and last name ) and job title for all employees whose salary is more than any salary of those employees whose job title is PU_MAN. Exclude job title PU_MAN.
73. Write a query to display the employee number, name( first name and last name ) and job title for all employees whose salary is more than any average salary of any department.
74. Write a query to display the employee name( first name and last name ) and department for all employees for any existence of those employees whose salary is more than 3700.
75. Write a query to display the department id and the total salary for those departments which contains at least one employee.
76. Write a query to display the employee id, name ( first name and last name ) and the job id column with a modified title SALESMAN for those employees whose job title is ST_MAN and DEVELOPER for whose job title is IT_PROG.
77. Write a query to display the employee id, name ( first name and last name ), salary and the SalaryStatus column with a title HIGH and LOW respectively for those employees whose salary is more than and less than the average salary of all employees.
78. Write a query to display the employee id, name ( first name and last name ), SalaryDrawn, AvgCompare (salary - the average salary of all employees) and the SalaryStatus column with a title HIGH and LOW respectively for those employees whose salary is more than and less than the average salary of all employees.
79. 
80. 
81. 
82. 
83. 
84. 
85. 
86. 
87. 
88. 
89. 
90. 




---------------------------------------------------------------------------------

--
-- Assignment Solution
-- 

1. SELECT first_name "First Name",  last_name "Last Name" FROM employees;
2. SELECT DISTINCT department_id FROM employees;
3. SELECT * FROM employees ORDER BY first_name DESC;
4. SELECT first_name, last_name, salary, salary*.15 PF FROM employees;
5. SELECT employee_id, first_name, last_name, salary FROM employees ORDER BY salary;
6. SELECT SUM(salary) FROM employees;
7. SELECT MAX(salary), MIN(salary) FROM employees;
8. SELECT AVG(salary), COUNT(*) FROM employees;
9. SELECT COUNT(*) FROM employees;
10. SELECT COUNT(DISTINCT job_id) FROM employees;
11. SELECT UPPER(first_name) FROM employees;
12. SELECT SUBSTRING(first_name,1,3) FROM employees;
13. SELECT 171*214+625 Result;
14. SELECT  CONCAT(first_name,' ', last_name) 'Employee Name' FROM employees;
15. SELECT TRIM(first_name) FROM employees;
16. SELECT first_name,last_name, LENGTH(first_name)+LENGTH(last_name)  'Length of  Names' FROM employees;
17. SELECT * FROM employees WHERE first_name REGEXP  '[0-9]';
18. SELECT employee_id, first_name FROM employees  LIMIT 10;
19. SELECT first_name, last_name, round(salary/12,2) as 'Monthly Salary' FROM employees;
20. SELECT first_name, last_name, salary FROM employees WHERE salary NOT BETWEEN 10000 AND 15000;
21. SELECT first_name, last_name, department_id FROM employees WHERE department_id IN (30, 100) ORDER BY  department_id  ASC;
22. SELECT first_name, last_name, salary, department_id FROM employees WHERE salary NOT BETWEEN 10000 AND 15000 AND department_id IN (30, 100);
23. SELECT first_name, last_name, hire_date FROM employees WHERE YEAR(hire_date)  LIKE '1987%';
24. SELECT first_name FROM employees WHERE first_name LIKE '%b%' AND first_name LIKE '%c%';
25. SELECT last_name, job_id, salary FROM employees WHERE job_id IN ('IT_PROG', 'SH_CLERK') AND salary NOT IN (4500,10000, 15000);
26. SELECT last_name FROM employees WHERE length(last_name) = 6;
27. SELECT last_name FROM employees WHERE last_name LIKE '__e%';
28. SELECT DISTINCT job_id  FROM employees;
29. SELECT first_name, last_name, salary, salary*.15 PF from employees;
30. SELECT * FROM employees WHERE last_name IN('JONES', 'BLAKE', 'SCOTT', 'KING', 'FORD');
31. SELECT * FROM employees WHERE LENGTH(first_name) >= 8;
32. SELECT job_id, LPAD( max_salary, 7, '0') ' Max Salary', LPAD( min_salary, 7, '0') ' Min Salary' FROM jobs;
33. SELECT email, reverse(substr(reverse(email), 5)) from employees;
34. SELECT * FROM employees WHERE first_name = BINARY UPPER(first_name);
35. SELECT RIGHT(phone_number, 4) as 'Ph.No.' FROM employees;
36. SELECT job_title, SUBSTR(job_title,1, INSTR(job_title, ' ')-1) FROM jobs;
37. SELECT first_name, last_name FROM employees WHERE INSTR(last_name,'C') > 2;
38. SELECT first_name "Name",LENGTH(first_name) "Length" FROM employees WHERE first_name LIKE 'J%' OR first_name LIKE 'M%' OR first_name LIKE 'A%' ORDER BY first_name ;
39. SELECT first_name, LPAD(salary, 10, '$') SALARY FROM employees;
40. SELECT COUNT(DISTINCT job_id) FROM employees;
41. SELECT SUM(salary) FROM employees;
42. SELECT MIN(salary) FROM employees;
43. SELECT MAX(salary) FROM employees WHERE job_id = 'IT_PROG';
44. SELECT AVG(salary),count(*) FROM employees WHERE department_id = 90;
45. SELECT ROUND(MAX(salary),0) 'Maximum',ROUND(MIN(salary),0) 'Minimum',ROUND(SUM(salary),0) 'Sum',ROUND(AVG(salary),0) 'Average'FROM employees;
46. SELECT job_id, COUNT(*) FROM employees GROUP BY job_id;
47. SELECT MAX(salary) - MIN(salary) DIFFERENCE FROM employees;
48. SELECT manager_id, MIN(salary) FROM employees WHERE manager_id IS NOT NULL GROUP BY manager_id ORDER BY MIN(salary) DESC;
49. SELECT department_id, SUM(salary) FROM employees GROUP BY department_id;
50. SELECT job_id, AVG(salary) FROM employees WHERE job_id <> 'IT_PROG' GROUP BY job_id;
51. SELECT job_id, SUM(salary), AVG(salary), MAX(salary), MIN(salary) FROM employees WHERE department_id = '90' GROUP BY job_id;
52. SELECT job_id, MAX(salary) FROM employees GROUP BY job_id HAVING MAX(salary) >=4000;
53. SELECT department_id, AVG(salary), COUNT(*) FROM employees GROUP BY department_id HAVING COUNT(*) > 10;
54. SELECT first_name, last_name FROM employees WHERE salary>(SELECT salary FROM employees WHERE employee_id=163);
55. SELECT first_name, last_name, salary, department_id, job_id FROM employees WHERE job_id =( SELECT job_id FROM employees WHERE employee_id=169 );
56. SELECT first_name, last_name, salary, department_id FROM employees WHERE salary IN (SELECT MIN(salary)FROM employees GROUP BY department_id);
57. SELECT employee_id, first_name,last_name FROM employees WHERE salary>( SELECT AVG(salary) FROM employees );
58. SELECT first_name, last_name, employee_id, salary FROM employees WHERE manager_id = (SELECT employee_id FROM employees WHERE first_name = 'Payam');
59. SELECT e.department_id, e.first_name, e.job_id , d.department_name FROM employees e , departments d WHERE e.department_id = d.department_id AND  d.department_name = 'Finance';
60. SELECT * FROM employees WHERE (salary,manager_id)= (SELECT 3000,121);
61. SELECT * FROM employees WHERE employee_id IN (134,159,183);
62. SELECT * FROM employees WHERE salary BETWEEN (SELECT 1000) AND (select 3000);
63. SELECT * FROM employees WHERE salary BETWEEN (SELECT MIN(salary) FROM employees) AND 2500;
64. SELECT * FROM employees WHERE department_id NOT IN (SELECT department_id FROM departments WHERE manager_id BETWEEN 100 AND 200);
65. SELECT * FROM employees WHERE employee_id IN (SELECT employee_id FROM employees WHERE salary = (SELECT MAX(salary) FROM employees WHERE salary < (SELECT MAX(salary) FROM employees)));
66. SELECT first_name, last_name, hire_date FROM employees WHERE department_id=( SELECT department_id FROM employees WHERE first_name = 'Clara') AND first_name <> 'Clara';
67. SELECT employee_id, first_name, last_name FROM employees WHERE department_id IN (SELECT department_id FROM employees WHERE first_name LIKE '%T%' );  
68. SELECT employee_id, first_name , salary FROM employees WHERE salary > (SELECT AVG (salary) FROM employees ) 
AND  department_id IN ( SELECT department_id  FROM employees WHERE first_name LIKE '%J%');
69. SELECT  first_name, last_name, employee_id, job_id FROM employees WHERE department_id = (SELECT department_id  
FROM departments WHERE location_id = (SELECT location_id FROM locations WHERE city ='Toronto'));
70. SELECT employee_id,first_name,last_name,job_id FROM employees WHERE salary < ANY ( SELECT salary FROM  employees WHERE job_id = 'MK_MAN' );
71. SELECT employee_id,first_name,last_name, job_id FROM employees WHERE salary < ANY ( SELECT salary FROM employees WHERE job_id = 'MK_MAN' ) AND job_id <> 'MK_MAN';
72. SELECT employee_id, first_name, last_name, job_id FROM employees WHERE salary > ALL ( SELECT salary FROM employees WHERE job_id = 'PU_MAN' ) AND job_id <> 'PU_MAN';
73. SELECT employee_id, first_name, last_name, job_id FROM employees WHERE salary > ALL ( SELECT AVG(salary) FROM employees GROUP BY department_id );
74. SELECT first_name, last_name, department_id FROM employees WHERE EXISTS (SELECT * FROM employees WHERE salary >3700 ); 
75. SELECT departments.department_id, result1.total_amt FROM departments, ( SELECT employees.department_id,  SUM(employees.salary) total_amt FROM employees GROUP BY department_id) result1 WHERE result1.department_id = departments.department_id;
76. SELECT  employee_id,  first_name, last_name, salary, CASE WHEN salary >= (SELECT AVG(salary) FROM employees) THEN 'HIGH' ELSE 'LOW' END AS SalaryStatus FROM employees;
77. SELECT  employee_id,  first_name, last_name,  salary AS SalaryDrawn, ROUND((salary -(SELECT AVG(salary) FROM employees)),2) AS AvgCompare, CASE  WHEN salary >= (SELECT AVG(salary) FROM employees) THEN 'HIGH' ELSE 'LOW'  
END AS SalaryStatus FROM employees;

Note: que 26 and onwards 
link{ https://www.w3resource.com/sql-exercises/sql-subqueries-exercises.php}

78. 
79. 
80. 
81. 
82. 
83. 
84. 
85. 
86. 
87. 
88. 
89. 
90. 






 
 
 
 
1. 
2. 
3. 
4. 
5. 
6. 
7. 
8. 
9. 
10.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 