DBT Assignment 

--
-- Assignment
-- 
1. Write a query to display the names (first_name, last_name) using alias name "First Name", "Last Name".
2. Write a query to get unique department ID from employee table.
3. Write a query to get all employee details from the employee table order by first name, descending.
4. Write a query to get the names (first_name, last_name), salary, PF of all the employees (PF is calculated as 15% of salary).
5. Write a query to get the employee ID, names (first_name, last_name), salary in ascending order of salary.
6. Write a query to get the total salaries payable to employees.
7. Write a query to get the maximum and minimum salary from employees table.
8. Write a query to get the average salary and number of employees in the employees table.
9. Write a query to get the number of employees working with the company.
10. Write a query to get the number of jobs available in the employees table.
11. Write a query get all first name from employees table in upper case.
12. Write a query to get the first 3 characters of first name from employees table.
13. Write a query to calculate 171*214+625.
14. Write a query to get the names (for example Ellen Abel, Sundar Ande etc.) of all the employees from employees table.
15. Write a query to get first name from employees table after removing white spaces from both side.
16. Write a query to get the length of the employee names (first_name, last_name) from employees table. 
17. Write a query to get the names (for example Ellen Abel, Sundar Ande etc.) whose salary is more than 15000.
18. Write a query to select first 10 records from a table.
19. Write a query to get monthly salary (round 2 decimal places) of each and every employee. (Note : Assume the salary field 	provides the 'annual salary' information.)
20. Write a query to display the name (first_name, last_name) and salary for all employees whose salary is not in the range    $ 10,000 through $15,000.
21. Write a query to display the name (first_name, last_name) and department ID of all employees in departments 30 or 100 in    ascending order.
22. Write a query to display the name (first_name, last_name) and salary for all employees whose salary is not in the range    $10,000 through $15,000 and are in department 30 or 100.
23. Write a query to display the name (first_name, last_name) and hire date for all employees who were hired in 1987.
24. Write a query to display the first_name of all employees who have both "b" and "c" in their first name.
25. Write a query to display the last name, job, and salary for all employees whose job is that of a "Programmer" or a       
    "Shipping Clerk", and whose salary is not equal to $4,500, $10,000, or $15,000.
26. Write a query to display the last name of employees whose names have exactly 6 characters.
27. Write a query to display the last name of employees having 'e' as the third character.
28. Write a query to display the jobs/designations available in the employees table.
29. Write a query to display the name (first_name, last_name), salary and PF (15% of salary) of all employees.
30. Write a query to select all record from employees where last name in 'BLAKE', 'SCOTT', 'KING' and 'FORD'.
31. Write a query to list the number of jobs available in the employees table.
32. Write a query to get the total salaries payable to employees.
33. Write a query to get the minimum salary from employees table. 
34. Write a query to get the maximum salary of an employee working as a Programmer.
35. Write a query to get the average salary and number of employees working the department 90.
36. Write a query to get the highest, lowest, sum, and average salary of all employees.
37. Write a query to get the number of employees with the same job.
38. Write a query to get the difference between the highest and lowest salaries.
39. Write a query to get the department ID and the total salary payable in each department.
40. Write a query to get the average salary for each job ID excluding programmer.
41. Write a query to get the total salary, maximum, minimum, average salary of employees (job ID wise), for department ID 90  only.
42. Write a query to get the job ID and maximum salary of the employees where maximum salary is greater than or equal to $4000. 
43. Write a query to get the average salary for all departments employing more than 10 employees.
44. Write a query to find the name (first_name, last_name) and the salary of the employees who have a higher salary than the employee whose last_name='Bull'.
45. Write a query to find the name (first_name, last_name) of all employees who works in the IT department. 
46. Write a query to find the name (first_name, last_name) of the employees who are working in a USA based department.
47. Write a query to find the name (first_name, last_name) of the employees who are managers.
48. Write a query to find the name (first_name, last_name), and salary of the employees whose salary is greater than the average salary.
49.  Write a query to find the name (first_name, last_name), and salary of the employees who earns more than the average salary and works in any of the IT departments.
50. Write a query to find the name (first_name, last_name), and salary of the employees who earns more than the earning of Mr. Bell. 
51. Write a query to find the addresses (location_id, street_address, city, state_province, country_name) of all the departments. (Use NATURAL JOIN.)
52. Write a query to find the name (first_name, last name), department ID and name of all the employees. 
53. Write a query to find the name (first_name, last_name), job, department ID and name of the employees who works in London. 
54. Write a query to find the employee id, employee name (last_name) along with their manager_id and managers name (last_name). 
55. Write a query to find the name (first_name, last_name) and hire date of the employees who was hired after 'Jones'.
56. Write a query to get the department name and number of employees in the department.
57. Write a query to find the employee ID, job title, number of days between ending date and starting date for all jobs in department 90. (hnt: use jobs and job_history tables)
58. Write a query to display the department name, manager name, and city.
59. Write a query to display the job title and average salary of employees.
60. Write a query to display job title, employee name, and the difference between salary of the employee and minimum salary for the job (hint: use employees and job tables).
61. Write a query to get the first name and hire date from employees table where hire date between '1987-06-01' and '1987-07-30'
62. Write a query to get the firstname, lastname who joined in the month of June.
63. Write a query to get the years in which more than 10 employees joined.
64. Write a query to get first name of employees who joined in 1987.
65. Write a query to get the department ID, year, and number of employees joined.
66. Write a query to get the job_id and related employees id.
	
	output must be as follows
	
	job_id	      Employees ID
	AC_ACCOUNT	  206
	AC_MGR	      205
	AD_ASST	      200
    AD_PRES	      100
    AD_VP	      101,102
    FI_ACCOUNT	  110,113,111,109,112
	
67. Write a query to update the portion of the phone_number in the employees table, within the phone number the substring '124' will be replaced by '999'.
68. Write a query to get the details of the employees where the length of the first name greater than or equal to 8.
69. Write a query to display leading zeros before maximum and minimum salary.
70. Write a query to append '@gmail.com' to email field.
71. Write a query to get the employee id, first name and hire month.
72. Write a query to get the employee id, email id (discard the last four characters).
73. Write a query to extract the last 4 character of phone numbers.
74. Write a query to get the locations that have minimum street length.
75. Write a query to display the length of first name for employees where last name contain character 'c' after 2nd position.
76. Write a query that displays the first name and the length of the first name for all employees whose name starts with the letters 'A', 'J' or 'M'. Give each column an appropriate label. Sort the results by the employees first names.
77. Write a query to display the first name and salary for all employees. Format the salary to be 10 characters long, left-padded with the $ symbol. Label the column SALARY. 
78. Write a query to display the employees details who are hired seventh month in any year.
79. Write a query to display the employees details who are hired on seventh day of any month.
80. Write a query to display the employees details who is getting minimum salary.



------------------------------------------------------------------------------------------------------------------------



--
-- Assignment Solution
-- 
1. SELECT first_name "First Name",  last_name "Last Name" FROM employees;
2. SELECT DISTINCT department_id FROM employees;
3. SELECT * FROM employees ORDER BY first_name DESC;
4. SELECT first_name, last_name, salary, salary*.15 PF FROM employees;
5. SELECT employee_id, first_name, last_name, salary FROM employees ORDER BY salary;
6. SELECT SUM(salary) FROM employees;
7. SELECT MAX(salary), MIN(salary) FROM employees;
8. SELECT AVG(salary), COUNT(*) FROM employees;
9. SELECT COUNT(*) FROM employees;
10. SELECT COUNT(DISTINCT job_id) FROM employees;
11. SELECT UPPER(first_name) FROM employees;
12. SELECT SUBSTRING(first_name,1,3) FROM employees;
13. SELECT 171*214+625 Result;
14. SELECT  CONCAT(first_name,' ', last_name) 'Employee Name' FROM employees;
15. SELECT TRIM(first_name) FROM employees;
16. SELECT first_name,last_name, LENGTH(first_name)+LENGTH(last_name)  'Length of  Names' FROM employees;
17. SELECT  CONCAT(first_name,' ', last_name) 'Employee Name' FROM employees where salary > 15000;
18. SELECT employee_id, first_name FROM employees  LIMIT 10;
19. SELECT first_name, last_name, round(salary/12,2) as 'Monthly Salary' FROM employees;
20. SELECT first_name, last_name, salary FROM employees WHERE salary NOT BETWEEN 10000 AND 15000;
21. SELECT first_name, last_name, department_id FROM employees WHERE department_id IN (30, 100) ORDER BY  department_id  ASC;
22. SELECT first_name, last_name, salary, department_id FROM employees WHERE salary NOT BETWEEN 10000 AND 15000 AND 
    department_id IN (30, 100);
23. SELECT first_name, last_name, hire_date FROM employees WHERE YEAR(hire_date)  = 1987;
24. SELECT first_name FROM employees WHERE first_name LIKE '%b%' AND first_name LIKE '%c%';
25. SELECT last_name, job_id, salary FROM employees WHERE job_id IN ('IT_PROG', 'SH_CLERK') AND salary NOT IN (4500, 10000,   15000);
26. SELECT last_name FROM employees WHERE length(last_name) = 6;
27. SELECT last_name FROM employees WHERE last_name LIKE '__e%';
28. SELECT DISTINCT job_id  FROM employees;
29. SELECT first_name, last_name, salary, salary*.15 PF from employees;
30. SELECT * FROM employees WHERE last_name IN('JONES', 'BLAKE', 'SCOTT', 'KING', 'FORD');
31. SELECT COUNT(DISTINCT job_id) FROM employees;
32. SELECT SUM(salary) FROM employees;
33. SELECT MIN(salary) FROM employees;
34. SELECT MAX(salary) FROM employees WHERE job_id = 'IT_PROG';
35. SELECT AVG(salary),count(*) FROM employees WHERE department_id = 90;
36. SELECT MAX(salary) 'Maximum', MIN(salary) 'Minimum', SUM(salary) 'Sum', AVG(salary) 'Average' FROM employees;
37. SELECT job_id, COUNT(*) FROM employees GROUP BY job_id;
38. SELECT MAX(salary) - MIN(salary) DIFFERENCE FROM employees;
39. SELECT department_id, SUM(salary) FROM employees GROUP BY department_id;
40. SELECT job_id, AVG(salary) FROM employees WHERE job_id <> 'IT_PROG' GROUP BY job_id;
41. SELECT job_id, SUM(salary), AVG(salary), MAX(salary), MIN(salary) FROM employees WHERE department_id = '90' GROUP BY   job_id;
42. SELECT job_id, MAX(salary) FROM employees GROUP BY job_id HAVING MAX(salary) >= 4000;
43. SELECT department_id, AVG(salary), COUNT(*) FROM employees GROUP BY department_idHAV ING COUNT(*) > 10;
44. SELECT FIRST_NAME, LAST_NAME, SALARY FROM employees WHERE SALARY > (SELECT salary FROM employees WHERE last_name = 'Bull');
45. SELECT first_name, last_name FROM employees WHERE department_id IN (SELECT department_id FROM departments WHERE department_name='IT');
46. select count(*) from employees, departments, locations where employees.DEPARTMENT_ID = departments.DEPARTMENT_ID and departments.LOCATION_ID = locations.LOCATION_ID and locations.COUNTRY_ID = 'US';
47. SELECT first_name, last_name FROM employees WHERE (employee_id IN (SELECT manager_id FROM employees));
48. SELECT first_name, last_name, salary FROM employees WHERE salary > (SELECT AVG(salary) FROM employees);
49. select * from employees where salary > (select avg(salary) from employees where DEPARTMENT_ID in (SELECT DEPARTMENT_ID FROM db1.departments where DEPARTMENT_NAME like 'it%'));
50. SELECT first_name, last_name, salary FROM employees WHERE salary > (SELECT salary FROM employees WHERE last_name = 'Bell') ORDER BY first_name;
51. SELECT location_id, street_address, city, state_province, country_name FROM locations NATURAL JOIN countries;
52. SELECT first_name, last_name, department_id, department_name FROM employees JOIN departments USING (department_id);
53. select employees.* from employees, departments, locations where employees.DEPARTMENT_ID = departments.DEPARTMENT_ID and departments.LOCATION_ID = locations.LOCATION_ID and city = 'London';
54. SELECT e.employee_id 'Emp_Id', e.last_name 'Employee', m.employee_id 'Mgr_Id', m.last_name 'Manager' FROM employees e, employees m where e.manager_id = m.employee_id;
55. select * from employees where hire_date > (select hire_date from employees where last_name = 'Jones')
56. SELECT department_name AS 'Department Name', COUNT(*) AS 'No of Employees' FROM departments, employees where employees.department_id = departments.department_id GROUP BY department_name ORDER BY department_name;
57. SELECT employee_id, job_title, end_date-start_date Days FROM jobs, job_history where  jobs.JOB_ID=job_history.JOB_ID and department_id=90;
58. SELECT d.department_id, d.department_name, d.manager_id, e.first_name FROM departments d, employees e where d.manager_id = e.employee_id;
59. SELECT job_title, AVG(salary) FROM employees NATURAL JOIN jobs GROUP BY job_title;
60. SELECT job_title, first_name, salary-min_salary 'Salary - Min_Salary' FROM employees NATURAL JOIN jobs;
61. SELECT FIRST_NAME, HIRE_DATE FROM employees WHERE HIRE_DATE BETWEEN '1987-06-01' AND '1987-07-30';
62. SELECT first_name, last_name FROM employees WHERE monthname(HIRE_DATE) =  'June';
63. SELECT year(HIRE_DATE) FROM employees GROUP BY year(HIRE_DATE) HAVING COUNT(EMPLOYEE_ID) > 10;
64. SELECT FIRST_NAME, HIRE_DATE FROM employees WHERE YEAR(HIRE_DATE)=1987;
65. SELECT DEPARTMENT_ID, year(HIRE_DATE), COUNT(EMPLOYEE_ID) FROM employees GROUP BY DEPARTMENT_ID ORDER BY DEPARTMENT_ID;
66. SELECT job_id, GROUP_CONCAT(employee_id) 'Employees ID' FROM employees GROUP BY job_id;
67. UPDATE employees SET phone_number = REPLACE(phone_number, '124', '999') WHERE phone_number LIKE '%124%';
68. SELECT * FROM employees WHERE LENGTH(first_name) >= 8;
69. SELECT job_id,  LPAD( max_salary, 7, '0') ' Max Salary', LPAD( min_salary, 7, '0') ' Min Salary' FROM jobs;
70. UPDATE employees SET email = CONCAT(email, '@gmail.com');
71. SELECT employee_id, first_name, MID(hire_date, 6, 2) as hire_month FROM employees;
72. SELECT email, substr(email,1, length(email) - 4) FROM employees ;
73. SELECT RIGHT(phone_number, 4) as 'Ph.No.' FROM employees;
74. SELECT * FROM locations WHERE LENGTH(street_address) <= (SELECT  MIN(LENGTH(street_address)) FROM locations);
75. SELECT first_name, last_name FROM employees WHERE INSTR(last_name,'C') > 2;
76. SELECT first_name "Name", LENGTH(first_name) "Length" FROM employees WHERE first_name LIKE 'J%' OR first_name LIKE 'M%' OR first_name LIKE 'A%' ORDER BY first_name ;
77. SELECT first_name, LPAD(salary, 10, '$') SALARY FROM employees;
78. SELECT * FROM employees where month(hire_date) = 7;
79. SELECT * FROM employees where day(hire_date) = 7;
80. select * from employees where salary = (select min(salary) from employees);